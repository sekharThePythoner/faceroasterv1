<!doctype html>
<html lang="hi chutiya">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>chutiya face detector</title>
  <style>
    body{margin:0;height:100vh;background:#0b0b0f;display:flex;align-items:center;justify-content:center;color:#fff;font-family:Inter,system-ui,Arial}
    #wrap{position:relative;width:90vw;max-width:900px;aspect-ratio:16/9;border-radius:16px;overflow:hidden;box-shadow:0 0 40px rgba(0,0,0,.6)}
    video#cam{width:100%;height:100%;object-fit:cover;transform:scaleX(-1);transition:filter .3s}
    canvas#overlay{position:absolute;inset:0;pointer-events:none}
    .msg{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);
         background:rgba(0,0,0,.45);padding:10px 20px;border-radius:999px;
         font-weight:600;backdrop-filter:blur(6px);opacity:0;transition:.3s}
    .msg.show{opacity:1;transform:translateX(-50%) translateY(-5px)}
  </style>
</head>
<body>
  <div id="wrap">
    <video id="cam" autoplay playsinline muted></video>
    <canvas id="overlay"></canvas>
    <div id="msg" class="msg">Starting camera...</div>
    <audio id="funny" src="funny.mp3" preload="auto"></audio>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

  <script>
  (async()=>{
    const video=document.getElementById('cam');
    const canvas=document.getElementById('overlay');
    const ctx=canvas.getContext('2d');
    const msg=document.getElementById('msg');
    const sound=document.getElementById('funny');
    let detected=false,lastSpeech=0;

    function speak(text){
      const now=Date.now();
      if(now-lastSpeech<2000)return; // limit chatter
      lastSpeech=now;
      const u=new SpeechSynthesisUtterance(text);
      u.lang='hi-IN';
      u.pitch=1.3;u.rate=1.1;
      speechSynthesis.speak(u);
    }

    function resize(){
      canvas.width=video.videoWidth;
      canvas.height=video.videoHeight;
    }

    function drawCircle(t){
      const w=canvas.width,h=canvas.height;
      const cx=w/2,cy=h/2,r=Math.min(w,h)/4;
      ctx.clearRect(0,0,w,h);
      ctx.save();
      ctx.beginPath();
      ctx.arc(cx,cy,r,0,Math.PI*2);
      ctx.strokeStyle=`rgba(122,170,255,${0.8+0.2*Math.sin(t/300)})`;
      ctx.lineWidth=4;ctx.stroke();ctx.restore();
      return{cx,cy,r};
    }

    function landmarksToBox(lm,w,h){
      let minX=1,minY=1,maxX=0,maxY=0;
      for(const p of lm){if(p.x<minX)minX=p.x;if(p.x>maxX)maxX=p.x;if(p.y<minY)minY=p.y;if(p.y>maxY)maxY=p.y;}
      const x=minX*w,y=minY*h,W=(maxX-minX)*w,H=(maxY-minY)*h;
      return{x,y,w:W,h:H,cx:x+W/2,cy:y+H/2};
    }

    const faceMesh=new FaceMesh({locateFile:(f)=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${f}`});
    faceMesh.setOptions({maxNumFaces:1,refineLandmarks:true,minDetectionConfidence:0.5,minTrackingConfidence:0.5});

    faceMesh.onResults((res)=>{
      if(!video.videoWidth)return;
      resize();
      const t=performance.now();
      const {cx,cy,r}=drawCircle(t);
      if(res.multiFaceLandmarks && res.multiFaceLandmarks.length>0){
        const lm=res.multiFaceLandmarks[0];
        const box=landmarksToBox(lm,canvas.width,canvas.height);
        const dx=box.cx-cx,dy=box.cy-cy;
        const dist=Math.sqrt(dx*dx+dy*dy);
        const inside=dist<r*0.5;
        video.style.filter=inside?'blur(4px) brightness(1.2)':'none';

        if(inside){
          if(!detected){
            detected=true;
            msg.textContent="finally chuddkar face dikh gaya";
            msg.classList.add('show');
            sound.currentTime=0;
            sound.play().catch(()=>{});
            speak("finally chuddkar face dikh gaya");
            setTimeout(()=>msg.classList.remove('show'),2500);
          }
        }else{
          detected=false;
          msg.textContent="face toh dikha re lawdee !ðŸ˜¡ðŸ˜¡";
          msg.classList.add('show');
          speak("face toh dikha re lawdee !ðŸ˜¡ðŸ˜¡");
        }
      }else{
        detected=false;
        video.style.filter='none';
        msg.textContent="face nahi mila ben ke shot !ðŸ¥€ðŸ¥€";
        msg.classList.add('dikhao apna chuddkar face');
        speak("face nahi mila ben ke shot");
      }
    });

    const camera=new Camera(video,{
      onFrame:async()=>{await faceMesh.send({image:video});},
      width:1280,height:720
    });
    camera.start();
  })();
  </script>
</body>
</html>
